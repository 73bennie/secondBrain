#!/usr/bin/env bash
set -euo pipefail

DB="${SB_DB:-$HOME/.secondbrain/brain.db}"

if [[ $# -eq 0 ]]; then
  echo "Usage: sb \"some thought\""
  exit 1
fi

text="$*"

# Escape single quotes for SQLite (replace ' with '')
escaped=$(printf "%s" "$text" | sed "s/'/''/g")

sqlite3 "$DB" <<SQL
INSERT INTO inbox (raw_text) VALUES ('$escaped');
INSERT INTO log_events (event, details) VALUES ('capture', 'captured');
SQL

echo "captured: $text"
